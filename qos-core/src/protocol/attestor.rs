use std::collections::BTreeSet;

use aws_nitro_enclaves_nsm_api as nsm;

use crate::protocol::{NsmDigest, NsmRequest, NsmResponse};

// https://github.com/aws/aws-nitro-enclaves-nsm-api/blob/main/docs/attestation_process.md
pub trait NsmProvider {
	fn nsm_process_request(&self, fd: i32, request: NsmRequest) -> NsmResponse;

	fn nsm_init(&self) -> i32;

	fn nsm_exit(&self, fd: i32);
}

pub struct Nsm;
impl NsmProvider for Nsm {
	fn nsm_process_request(&self, fd: i32, request: NsmRequest) -> NsmResponse {
		nsm::driver::nsm_process_request(fd, request.into()).into()
	}

	fn nsm_init(&self) -> i32 {
		nsm::driver::nsm_init()
	}

	fn nsm_exit(&self, fd: i32) {
		nsm::driver::nsm_exit(fd)
	}
}

/// TODO: - this should be moved to its own crate as it will likely need some
/// additional deps like Serde
pub struct MockNsm;
impl NsmProvider for MockNsm {
	fn nsm_process_request(
		&self,
		_fd: i32,
		request: NsmRequest,
	) -> NsmResponse {
		match request {
			NsmRequest::Attestation {
				user_data: _,
				nonce: _,
				public_key: _,
			} => NsmResponse::Attestation {
				document: MOCK_NSM_ATTESTATION_DOCUMENT.to_vec(),
			},
			NsmRequest::DescribeNSM => NsmResponse::DescribeNSM {
				version_major: 1,
				version_minor: 2,
				version_patch: 14,
				module_id: "mock_module_id".to_string(),
				max_pcrs: 1024,
				locked_pcrs: BTreeSet::from([90, 91, 92]),
				digest: NsmDigest::SHA256,
			},
			NsmRequest::ExtendPCR { index: _, data: _ } => {
				NsmResponse::ExtendPCR { data: vec![3, 4, 7, 4] }
			}
			NsmRequest::GetRandom => {
				NsmResponse::GetRandom { random: vec![4, 2, 0, 69] }
			}
			NsmRequest::LockPCR { index: _ } => NsmResponse::LockPCR,
			NsmRequest::LockPCRs { range: _ } => NsmResponse::LockPCRs,
			NsmRequest::DescribePCR { index: _ } => {
				NsmResponse::DescribePCR { lock: false, data: vec![3, 4, 7, 4] }
			}
		}
	}

	fn nsm_init(&self) -> i32 {
		33
	}

	fn nsm_exit(&self, fd: i32) {
		// Should be hardcoded to value returned by nsm_init
		assert_eq!(fd, 33);
		println!("nsm_exit");
	}
}

/// DO NOT USE IN PRODUCTION - only for tests.
pub const MOCK_NSM_ATTESTATION_DOCUMENT: &[u8] = &[
	132, 68, 161, 1, 56, 34, 160, 89, 19, 220, 169, 105, 109, 111, 100, 117,
	108, 101, 95, 105, 100, 120, 39, 105, 45, 48, 99, 54, 56, 101, 99, 57, 100,
	50, 99, 55, 102, 56, 56, 50, 101, 56, 45, 101, 110, 99, 48, 49, 56, 48, 99,
	102, 99, 102, 100, 99, 48, 54, 97, 51, 99, 97, 102, 100, 105, 103, 101,
	115, 116, 102, 83, 72, 65, 51, 56, 52, 105, 116, 105, 109, 101, 115, 116,
	97, 109, 112, 27, 0, 0, 1, 128, 207, 208, 6, 83, 100, 112, 99, 114, 115,
	176, 0, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 1, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 2, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 3, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 88, 48, 26, 168, 192, 140, 173, 25, 127, 31,
	229, 123, 209, 158, 184, 181, 98, 57, 109, 39, 65, 111, 164, 166, 206, 203,
	135, 94, 25, 124, 131, 82, 66, 96, 92, 110, 185, 109, 116, 109, 171, 158,
	151, 193, 146, 98, 73, 208, 143, 74, 5, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 88, 48, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 88, 48, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 88, 48, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 88, 48, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 88,
	48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11,
	88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 12, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 13, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 14, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 15, 88, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 0, 0, 0, 0, 107, 99, 101, 114, 116, 105, 102, 105, 99, 97,
	116, 101, 89, 2, 126, 48, 130, 2, 122, 48, 130, 2, 1, 160, 3, 2, 1, 2, 2,
	16, 1, 128, 207, 207, 220, 6, 163, 202, 0, 0, 0, 0, 98, 131, 6, 38, 48, 10,
	6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48, 129, 142, 49, 11, 48, 9, 6, 3, 85,
	4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115,
	104, 105, 110, 103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7,
	83, 101, 97, 116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6,
	65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87,
	83, 49, 57, 48, 55, 6, 3, 85, 4, 3, 12, 48, 105, 45, 48, 99, 54, 56, 101,
	99, 57, 100, 50, 99, 55, 102, 56, 56, 50, 101, 56, 46, 117, 115, 45, 101,
	97, 115, 116, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45,
	101, 110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 53, 49,
	55, 48, 50, 49, 57, 49, 53, 90, 23, 13, 50, 50, 48, 53, 49, 55, 48, 53, 49,
	57, 49, 56, 90, 48, 129, 147, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83,
	49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110, 103,
	116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97, 116,
	116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122,
	111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 62, 48,
	60, 6, 3, 85, 4, 3, 12, 53, 105, 45, 48, 99, 54, 56, 101, 99, 57, 100, 50,
	99, 55, 102, 56, 56, 50, 101, 56, 45, 101, 110, 99, 48, 49, 56, 48, 99,
	102, 99, 102, 100, 99, 48, 54, 97, 51, 99, 97, 46, 117, 115, 45, 101, 97,
	115, 116, 45, 49, 46, 97, 119, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72,
	206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 64, 233, 7, 173, 105,
	145, 172, 7, 38, 139, 151, 196, 130, 50, 200, 176, 180, 184, 126, 63, 183,
	108, 30, 73, 196, 122, 128, 168, 176, 139, 3, 56, 77, 29, 100, 31, 225,
	249, 75, 2, 211, 49, 205, 94, 228, 238, 213, 160, 217, 110, 187, 2, 77,
	105, 124, 86, 112, 175, 167, 83, 158, 182, 44, 94, 202, 245, 139, 23, 102,
	176, 11, 80, 120, 167, 129, 115, 148, 230, 134, 116, 96, 94, 40, 110, 34,
	21, 91, 75, 152, 235, 96, 199, 234, 169, 38, 7, 163, 29, 48, 27, 48, 12, 6,
	3, 85, 29, 19, 1, 1, 255, 4, 2, 48, 0, 48, 11, 6, 3, 85, 29, 15, 4, 4, 3,
	2, 6, 192, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 103, 0, 48, 100,
	2, 48, 38, 61, 99, 118, 200, 165, 151, 107, 27, 135, 33, 126, 114, 241,
	145, 19, 242, 162, 157, 210, 203, 38, 102, 251, 177, 229, 159, 29, 97, 177,
	202, 40, 241, 131, 151, 5, 60, 32, 30, 60, 91, 23, 26, 43, 29, 129, 84,
	162, 2, 48, 46, 121, 230, 144, 42, 154, 92, 26, 133, 154, 160, 159, 183,
	44, 53, 253, 159, 165, 202, 165, 198, 126, 17, 255, 214, 6, 238, 208, 153,
	20, 255, 166, 128, 213, 108, 67, 142, 25, 51, 216, 148, 204, 142, 67, 92,
	143, 220, 191, 104, 99, 97, 98, 117, 110, 100, 108, 101, 132, 89, 2, 21,
	48, 130, 2, 17, 48, 130, 1, 150, 160, 3, 2, 1, 2, 2, 17, 0, 249, 49, 117,
	104, 27, 144, 175, 225, 29, 70, 204, 180, 228, 231, 248, 86, 48, 10, 6, 8,
	42, 134, 72, 206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19,
	2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111,
	110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6,
	3, 85, 4, 3, 12, 18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101,
	110, 99, 108, 97, 118, 101, 115, 48, 30, 23, 13, 49, 57, 49, 48, 50, 56,
	49, 51, 50, 56, 48, 53, 90, 23, 13, 52, 57, 49, 48, 50, 56, 49, 52, 50, 56,
	48, 53, 90, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15,
	48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10,
	6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12, 18,
	97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118,
	101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 5, 43, 129,
	4, 0, 34, 3, 98, 0, 4, 252, 2, 84, 235, 166, 8, 193, 243, 104, 112, 226,
	154, 218, 144, 190, 70, 56, 50, 146, 115, 110, 137, 75, 255, 246, 114, 217,
	137, 68, 75, 80, 81, 229, 52, 164, 177, 246, 219, 227, 192, 188, 88, 26,
	50, 183, 177, 118, 7, 14, 222, 18, 214, 154, 63, 234, 33, 27, 102, 231, 82,
	207, 125, 209, 221, 9, 95, 111, 19, 112, 244, 23, 8, 67, 217, 220, 16, 1,
	33, 228, 207, 99, 1, 40, 9, 102, 68, 135, 201, 121, 98, 132, 48, 77, 197,
	63, 244, 163, 66, 48, 64, 48, 15, 6, 3, 85, 29, 19, 1, 1, 255, 4, 5, 48, 3,
	1, 1, 255, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 144, 37, 181, 13, 217,
	5, 71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48,
	14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 10, 6, 8, 42, 134,
	72, 206, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, 163, 127, 47, 145, 161,
	201, 189, 94, 231, 184, 98, 124, 22, 152, 210, 85, 3, 142, 31, 3, 67, 249,
	91, 99, 169, 98, 140, 61, 57, 128, 149, 69, 161, 30, 188, 191, 46, 59, 85,
	216, 174, 238, 113, 180, 195, 214, 173, 243, 2, 49, 0, 162, 243, 155, 22,
	5, 178, 112, 40, 165, 221, 75, 160, 105, 181, 1, 110, 101, 180, 251, 222,
	143, 224, 6, 29, 106, 83, 25, 127, 156, 218, 245, 217, 67, 188, 97, 252,
	43, 235, 3, 203, 111, 238, 141, 35, 2, 243, 223, 246, 89, 2, 193, 48, 130,
	2, 189, 48, 130, 2, 68, 160, 3, 2, 1, 2, 2, 16, 101, 199, 204, 202, 87, 14,
	220, 16, 15, 61, 225, 212, 138, 102, 255, 157, 48, 10, 6, 8, 42, 134, 72,
	206, 61, 4, 3, 3, 48, 73, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49,
	15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48,
	10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 27, 48, 25, 6, 3, 85, 4, 3, 12,
	18, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97,
	118, 101, 115, 48, 30, 23, 13, 50, 50, 48, 53, 49, 50, 48, 51, 51, 50, 53,
	54, 90, 23, 13, 50, 50, 48, 54, 48, 49, 48, 52, 51, 50, 53, 54, 90, 48,
	100, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 15, 48, 13, 6, 3,
	85, 4, 10, 12, 6, 65, 109, 97, 122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4,
	11, 12, 3, 65, 87, 83, 49, 54, 48, 52, 6, 3, 85, 4, 3, 12, 45, 55, 55, 97,
	53, 97, 49, 51, 55, 54, 55, 97, 54, 99, 56, 51, 49, 46, 117, 115, 45, 101,
	97, 115, 116, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45,
	101, 110, 99, 108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72,
	206, 61, 2, 1, 6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 222, 252, 141, 69,
	152, 48, 54, 180, 63, 68, 105, 37, 175, 123, 59, 155, 212, 162, 176, 82,
	168, 225, 2, 86, 52, 16, 138, 20, 104, 46, 28, 70, 228, 6, 173, 133, 36,
	227, 73, 160, 184, 8, 102, 96, 219, 251, 137, 217, 240, 167, 124, 168, 90,
	214, 190, 71, 206, 190, 26, 147, 11, 32, 157, 109, 103, 155, 95, 77, 251,
	77, 99, 42, 102, 192, 206, 112, 250, 243, 241, 234, 30, 20, 208, 162, 218,
	74, 186, 68, 36, 200, 14, 159, 33, 160, 12, 66, 163, 129, 213, 48, 129,
	210, 48, 18, 6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 2,
	48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 144, 37, 181, 13, 217, 5,
	71, 231, 150, 195, 150, 250, 114, 157, 207, 153, 169, 223, 75, 150, 48, 29,
	6, 3, 85, 29, 14, 4, 22, 4, 20, 133, 27, 7, 162, 173, 220, 156, 98, 111,
	180, 23, 177, 10, 241, 150, 225, 121, 125, 252, 202, 48, 14, 6, 3, 85, 29,
	15, 1, 1, 255, 4, 4, 3, 2, 1, 134, 48, 108, 6, 3, 85, 29, 31, 4, 101, 48,
	99, 48, 97, 160, 95, 160, 93, 134, 91, 104, 116, 116, 112, 58, 47, 47, 97,
	119, 115, 45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101,
	115, 45, 99, 114, 108, 46, 115, 51, 46, 97, 109, 97, 122, 111, 110, 97,
	119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 97, 98, 52, 57, 54, 48,
	99, 99, 45, 55, 100, 54, 51, 45, 52, 50, 98, 100, 45, 57, 101, 57, 102, 45,
	53, 57, 51, 51, 56, 99, 98, 54, 55, 102, 56, 52, 46, 99, 114, 108, 48, 10,
	6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 103, 0, 48, 100, 2, 48, 97, 16,
	159, 217, 30, 69, 151, 35, 31, 115, 87, 240, 159, 181, 162, 247, 229, 229,
	175, 156, 93, 186, 83, 52, 225, 235, 45, 2, 148, 133, 10, 218, 189, 174,
	86, 206, 154, 17, 82, 119, 75, 208, 223, 216, 100, 244, 223, 27, 2, 48, 20,
	146, 166, 67, 119, 132, 151, 250, 100, 67, 177, 102, 112, 250, 234, 30, 55,
	83, 97, 104, 45, 137, 13, 60, 25, 50, 92, 19, 227, 106, 251, 102, 117, 38,
	161, 227, 177, 251, 11, 94, 129, 152, 1, 196, 197, 203, 128, 117, 89, 3,
	23, 48, 130, 3, 19, 48, 130, 2, 154, 160, 3, 2, 1, 2, 2, 16, 66, 191, 173,
	106, 243, 245, 153, 100, 102, 84, 221, 162, 118, 15, 1, 196, 48, 10, 6, 8,
	42, 134, 72, 206, 61, 4, 3, 3, 48, 100, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19,
	2, 85, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111,
	110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 54, 48, 52, 6,
	3, 85, 4, 3, 12, 45, 55, 55, 97, 53, 97, 49, 51, 55, 54, 55, 97, 54, 99,
	56, 51, 49, 46, 117, 115, 45, 101, 97, 115, 116, 45, 49, 46, 97, 119, 115,
	46, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 48,
	30, 23, 13, 50, 50, 48, 53, 49, 54, 50, 50, 51, 48, 49, 56, 90, 23, 13, 50,
	50, 48, 53, 50, 50, 50, 49, 51, 48, 49, 56, 90, 48, 129, 137, 49, 60, 48,
	58, 6, 3, 85, 4, 3, 12, 51, 97, 99, 55, 99, 101, 98, 99, 48, 54, 102, 52,
	101, 98, 98, 50, 98, 46, 122, 111, 110, 97, 108, 46, 117, 115, 45, 101, 97,
	115, 116, 45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101,
	110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3,
	65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97, 122, 111,
	110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 11, 48, 9, 6, 3, 85,
	4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97,
	116, 116, 108, 101, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6,
	5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 132, 96, 229, 136, 115, 25, 148, 177, 3,
	239, 253, 83, 20, 162, 171, 242, 6, 39, 97, 110, 155, 216, 112, 201, 132,
	5, 243, 151, 40, 179, 209, 184, 115, 218, 185, 217, 23, 250, 67, 45, 179,
	172, 254, 154, 182, 150, 247, 12, 54, 159, 232, 139, 74, 101, 88, 59, 48,
	163, 200, 223, 199, 102, 148, 51, 38, 109, 227, 140, 112, 15, 13, 237, 128,
	229, 179, 130, 105, 206, 113, 141, 59, 241, 36, 140, 191, 217, 98, 232,
	165, 232, 70, 255, 156, 41, 57, 172, 163, 129, 234, 48, 129, 231, 48, 18,
	6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 1, 48, 31, 6, 3,
	85, 29, 35, 4, 24, 48, 22, 128, 20, 133, 27, 7, 162, 173, 220, 156, 98,
	111, 180, 23, 177, 10, 241, 150, 225, 121, 125, 252, 202, 48, 29, 6, 3, 85,
	29, 14, 4, 22, 4, 20, 64, 234, 253, 247, 84, 156, 144, 3, 154, 191, 59,
	159, 177, 155, 197, 150, 178, 18, 8, 187, 48, 14, 6, 3, 85, 29, 15, 1, 1,
	255, 4, 4, 3, 2, 1, 134, 48, 129, 128, 6, 3, 85, 29, 31, 4, 121, 48, 119,
	48, 117, 160, 115, 160, 113, 134, 111, 104, 116, 116, 112, 58, 47, 47, 99,
	114, 108, 45, 117, 115, 45, 101, 97, 115, 116, 45, 49, 45, 97, 119, 115,
	45, 110, 105, 116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 46,
	115, 51, 46, 117, 115, 45, 101, 97, 115, 116, 45, 49, 46, 97, 109, 97, 122,
	111, 110, 97, 119, 115, 46, 99, 111, 109, 47, 99, 114, 108, 47, 99, 102,
	52, 53, 54, 53, 97, 101, 45, 102, 57, 50, 102, 45, 52, 99, 49, 49, 45, 97,
	56, 55, 54, 45, 101, 51, 55, 102, 102, 57, 49, 100, 51, 54, 98, 53, 46, 99,
	114, 108, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 3, 103, 0, 48, 100,
	2, 48, 0, 141, 147, 219, 43, 141, 203, 251, 249, 65, 14, 59, 101, 58, 52,
	17, 94, 125, 255, 136, 2, 119, 77, 162, 172, 220, 228, 96, 248, 224, 23,
	70, 232, 179, 196, 64, 148, 253, 75, 153, 4, 125, 112, 234, 156, 106, 224,
	228, 2, 48, 113, 100, 127, 5, 242, 8, 183, 52, 198, 118, 237, 86, 219, 91,
	20, 89, 92, 154, 237, 13, 160, 230, 178, 78, 214, 86, 204, 233, 200, 195,
	178, 149, 33, 114, 132, 209, 28, 126, 120, 190, 203, 61, 219, 145, 44, 76,
	113, 255, 89, 2, 129, 48, 130, 2, 125, 48, 130, 2, 4, 160, 3, 2, 1, 2, 2,
	20, 89, 91, 125, 245, 221, 115, 39, 32, 198, 129, 41, 209, 134, 253, 7,
	213, 175, 51, 158, 192, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3, 48,
	129, 137, 49, 60, 48, 58, 6, 3, 85, 4, 3, 12, 51, 97, 99, 55, 99, 101, 98,
	99, 48, 54, 102, 52, 101, 98, 98, 50, 98, 46, 122, 111, 110, 97, 108, 46,
	117, 115, 45, 101, 97, 115, 116, 45, 49, 46, 97, 119, 115, 46, 110, 105,
	116, 114, 111, 45, 101, 110, 99, 108, 97, 118, 101, 115, 49, 12, 48, 10, 6,
	3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6,
	65, 109, 97, 122, 111, 110, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83,
	49, 11, 48, 9, 6, 3, 85, 4, 8, 12, 2, 87, 65, 49, 16, 48, 14, 6, 3, 85, 4,
	7, 12, 7, 83, 101, 97, 116, 116, 108, 101, 48, 30, 23, 13, 50, 50, 48, 53,
	49, 55, 48, 49, 51, 50, 50, 55, 90, 23, 13, 50, 50, 48, 53, 49, 56, 48, 49,
	51, 50, 50, 55, 90, 48, 129, 142, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85,
	83, 49, 19, 48, 17, 6, 3, 85, 4, 8, 12, 10, 87, 97, 115, 104, 105, 110,
	103, 116, 111, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 12, 7, 83, 101, 97,
	116, 116, 108, 101, 49, 15, 48, 13, 6, 3, 85, 4, 10, 12, 6, 65, 109, 97,
	122, 111, 110, 49, 12, 48, 10, 6, 3, 85, 4, 11, 12, 3, 65, 87, 83, 49, 57,
	48, 55, 6, 3, 85, 4, 3, 12, 48, 105, 45, 48, 99, 54, 56, 101, 99, 57, 100,
	50, 99, 55, 102, 56, 56, 50, 101, 56, 46, 117, 115, 45, 101, 97, 115, 116,
	45, 49, 46, 97, 119, 115, 46, 110, 105, 116, 114, 111, 45, 101, 110, 99,
	108, 97, 118, 101, 115, 48, 118, 48, 16, 6, 7, 42, 134, 72, 206, 61, 2, 1,
	6, 5, 43, 129, 4, 0, 34, 3, 98, 0, 4, 217, 7, 202, 144, 1, 20, 13, 53, 232,
	63, 221, 159, 225, 146, 134, 69, 146, 118, 201, 153, 160, 175, 125, 29, 75,
	209, 208, 17, 139, 60, 241, 95, 234, 41, 212, 7, 177, 124, 161, 204, 166,
	194, 44, 133, 232, 176, 11, 144, 63, 152, 193, 125, 85, 145, 72, 245, 151,
	42, 102, 105, 84, 31, 79, 155, 24, 147, 140, 242, 204, 199, 198, 96, 157,
	105, 8, 157, 169, 22, 102, 10, 112, 140, 221, 71, 210, 113, 87, 135, 200,
	112, 157, 56, 193, 192, 141, 100, 163, 38, 48, 36, 48, 18, 6, 3, 85, 29,
	19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2, 1, 0, 48, 14, 6, 3, 85, 29, 15,
	1, 1, 255, 4, 4, 3, 2, 2, 4, 48, 10, 6, 8, 42, 134, 72, 206, 61, 4, 3, 3,
	3, 103, 0, 48, 100, 2, 48, 15, 118, 172, 221, 229, 239, 80, 139, 142, 77,
	175, 85, 204, 40, 253, 36, 69, 183, 3, 228, 119, 41, 137, 22, 191, 207,
	224, 87, 24, 125, 66, 154, 118, 221, 241, 153, 247, 77, 201, 49, 99, 4,
	183, 219, 210, 69, 112, 100, 2, 48, 44, 231, 245, 61, 54, 161, 162, 170,
	57, 172, 91, 91, 60, 143, 204, 18, 118, 143, 208, 21, 163, 144, 107, 213,
	109, 255, 239, 142, 56, 218, 105, 255, 3, 95, 135, 135, 226, 39, 127, 155,
	15, 41, 166, 150, 253, 186, 42, 61, 106, 112, 117, 98, 108, 105, 99, 95,
	107, 101, 121, 89, 3, 32, 45, 45, 45, 45, 45, 66, 69, 71, 73, 78, 32, 80,
	85, 66, 76, 73, 67, 32, 75, 69, 89, 45, 45, 45, 45, 45, 10, 77, 73, 73, 67,
	73, 106, 65, 78, 66, 103, 107, 113, 104, 107, 105, 71, 57, 119, 48, 66, 65,
	81, 69, 70, 65, 65, 79, 67, 65, 103, 56, 65, 77, 73, 73, 67, 67, 103, 75,
	67, 65, 103, 69, 65, 54, 115, 57, 103, 121, 102, 107, 77, 50, 69, 108, 53,
	107, 50, 78, 99, 89, 70, 110, 100, 10, 105, 55, 49, 52, 106, 122, 77, 86,
	79, 119, 85, 54, 80, 110, 75, 107, 43, 83, 122, 111, 101, 47, 83, 66, 104,
	70, 49, 56, 111, 99, 106, 119, 85, 115, 47, 54, 57, 82, 86, 113, 71, 71,
	48, 67, 69, 82, 88, 109, 55, 67, 114, 113, 70, 87, 89, 99, 51, 76, 57, 79,
	79, 90, 52, 89, 10, 67, 119, 106, 66, 57, 112, 49, 57, 100, 83, 75, 74,
	122, 50, 74, 113, 82, 88, 84, 99, 65, 43, 47, 66, 56, 47, 55, 57, 48, 98,
	97, 110, 69, 109, 113, 106, 73, 53, 76, 66, 101, 56, 68, 118, 100, 102, 47,
	112, 51, 100, 84, 118, 75, 49, 72, 47, 67, 89, 122, 111, 119, 86, 65, 115,
	10, 117, 47, 111, 79, 99, 81, 84, 57, 119, 77, 67, 108, 48, 56, 56, 106,
	101, 67, 118, 105, 54, 102, 89, 52, 113, 121, 75, 70, 101, 71, 98, 88, 67,
	82, 71, 75, 84, 105, 81, 106, 122, 99, 103, 121, 80, 71, 57, 101, 52, 74,
	121, 110, 74, 75, 118, 117, 77, 120, 81, 67, 112, 97, 52, 72, 10, 70, 117,
	116, 65, 48, 73, 53, 98, 113, 108, 43, 68, 120, 80, 80, 106, 49, 87, 83,
	99, 83, 72, 50, 85, 102, 70, 118, 120, 67, 118, 85, 115, 97, 115, 106, 102,
	89, 114, 69, 43, 51, 97, 112, 101, 86, 72, 47, 55, 70, 68, 69, 106, 115,
	52, 56, 86, 84, 47, 97, 48, 111, 74, 105, 98, 10, 82, 67, 71, 100, 48, 85,
	70, 89, 83, 118, 66, 109, 66, 112, 115, 107, 76, 77, 121, 109, 66, 78, 48,
	57, 102, 75, 118, 100, 90, 79, 112, 111, 105, 83, 78, 97, 48, 97, 90, 70,
	119, 67, 116, 113, 121, 88, 54, 72, 48, 89, 109, 74, 120, 113, 111, 105,
	113, 99, 111, 78, 78, 118, 47, 68, 10, 56, 116, 110, 65, 109, 120, 102, 73,
	120, 114, 105, 73, 52, 116, 102, 90, 69, 73, 100, 107, 97, 78, 103, 88, 76,
	89, 79, 102, 49, 99, 106, 117, 74, 83, 117, 74, 97, 111, 83, 66, 99, 72,
	122, 48, 73, 98, 47, 82, 117, 86, 80, 100, 83, 85, 75, 104, 90, 83, 114,
	121, 110, 84, 47, 102, 10, 72, 98, 106, 112, 120, 121, 103, 112, 97, 104,
	110, 84, 49, 76, 43, 85, 101, 47, 68, 103, 110, 87, 75, 56, 67, 56, 83, 72,
	84, 85, 99, 76, 122, 115, 81, 109, 68, 67, 68, 65, 43, 49, 54, 65, 106, 53,
	98, 112, 55, 55, 43, 81, 80, 78, 47, 114, 85, 120, 88, 55, 69, 98, 88, 79,
	10, 105, 119, 47, 73, 115, 114, 57, 114, 47, 74, 98, 98, 69, 107, 89, 47,
	48, 89, 105, 88, 47, 113, 114, 56, 103, 98, 54, 81, 56, 89, 112, 90, 121,
	82, 52, 97, 104, 56, 86, 49, 86, 87, 71, 82, 102, 122, 90, 49, 72, 49, 48,
	53, 77, 67, 54, 107, 88, 107, 47, 66, 85, 120, 78, 121, 10, 76, 85, 86, 56,
	111, 66, 65, 87, 89, 108, 52, 57, 47, 107, 120, 114, 109, 82, 73, 122, 90,
	99, 48, 118, 120, 117, 70, 122, 54, 81, 122, 105, 113, 54, 108, 54, 74,
	120, 49, 53, 98, 89, 50, 120, 103, 68, 122, 115, 48, 90, 74, 103, 54, 75,
	67, 71, 112, 71, 48, 99, 106, 54, 117, 121, 10, 68, 57, 104, 82, 82, 52,
	109, 118, 117, 77, 115, 75, 115, 47, 50, 105, 79, 49, 89, 85, 68, 99, 107,
	48, 118, 65, 53, 101, 48, 81, 117, 84, 89, 67, 97, 89, 72, 69, 66, 74, 51,
	110, 83, 73, 88, 83, 115, 76, 75, 76, 81, 101, 71, 57, 111, 99, 77, 74, 77,
	88, 50, 105, 51, 103, 10, 110, 86, 105, 43, 86, 49, 82, 69, 83, 102, 75,
	69, 101, 117, 102, 102, 90, 82, 75, 69, 112, 106, 69, 67, 65, 119, 69, 65,
	65, 81, 61, 61, 10, 45, 45, 45, 45, 45, 69, 78, 68, 32, 80, 85, 66, 76, 73,
	67, 32, 75, 69, 89, 45, 45, 45, 45, 45, 10, 105, 117, 115, 101, 114, 95,
	100, 97, 116, 97, 246, 101, 110, 111, 110, 99, 101, 246, 88, 96, 174, 48,
	177, 39, 24, 48, 211, 165, 107, 86, 21, 216, 93, 143, 22, 156, 203, 98,
	163, 5, 213, 87, 210, 213, 90, 98, 93, 46, 150, 155, 75, 81, 186, 194, 134,
	36, 254, 23, 84, 26, 185, 37, 248, 150, 72, 16, 193, 246, 96, 76, 65, 78,
	5, 133, 136, 18, 42, 87, 137, 82, 56, 245, 113, 139, 121, 164, 201, 244,
	237, 101, 116, 109, 204, 13, 116, 108, 58, 74, 181, 32, 208, 172, 36, 44,
	187, 171, 138, 185, 80, 105, 171, 65, 177, 74, 136, 33,
];
